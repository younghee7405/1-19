import pandas as pd
import numpy as np
import os

def generate_messy_trade_data():
    """
    ê³¼ì œ 1(í•„í„°ë§)ê³¼ ê³¼ì œ 2(í´ë Œì§•) ìˆ˜í–‰ì„ ìœ„í•œ 
    ì˜ë„ì ìœ¼ë¡œ ì˜¤ì—¼ëœ ë¬´ì—­ ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    """
    np.random.seed(42)
    rows = 100

    # 1. ê¸°ë³¸ ì»¬ëŸ¼ ìƒì„±
    data = {
        'ë‚ ì§œ': pd.date_range(start='2025-01-01', periods=rows, freq='D').strftime('%Y-%m-%d'),
        'í†µê´€ë²ˆí˜¸': [f'TX-{np.random.randint(10000, 99999)}' for _ in range(rows)],
        'êµ­ê°€ëª…': np.random.choice(['ë¯¸êµ­', 'ë² íŠ¸ë‚¨', 'ì¤‘êµ­', 'ì¼ë³¸', 'ë…ì¼'], rows),
        # HSì½”ë“œ: ë°˜ë„ì²´(85)ì™€ ê¸°íƒ€(84, 87) í˜¼í•©
        'hs_code': np.random.choice(['8542311010', '8541100000', '8471300000', '8703231010'], rows),
        # ìˆ˜ì¶œê¸ˆì•¡: ë‹¨ìœ„ëŠ” 'ì›' (ê³¼ì œ 2ë¥¼ ìœ„í•´ í° ìˆ«ìë¡œ ìƒì„±), ê³¼ì œ 1ì„ ìœ„í•´ ì¼ë¶€ 0ì› í¬í•¨
        'ìˆ˜ì¶œê¸ˆì•¡': np.random.choice([0, 135000000, 270000000, 675000000, 1350000000], rows),
        # ìˆ˜ì¶œì…êµ¬ë¶„: ì˜ë¬¸ í˜¼ìš© (ê³¼ì œ 2 ì •ì œìš©)
        'ìˆ˜ì¶œì…êµ¬ë¶„': np.random.choice(['Export', 'Import'], rows),
        # ì¤‘ëŸ‰: ê²°ì¸¡ì¹˜(NaN) ê°•ì œ ì£¼ì… (ê³¼ì œ 2 ì •ì œìš©)
        'ì¤‘ëŸ‰': [np.random.uniform(50, 500) if np.random.random() > 0.15 else np.nan for _ in range(rows)]
    }

    df = pd.DataFrame(data)

    # ê³¼ì œ 1ì˜ 'ë¯¸êµ­/ë² íŠ¸ë‚¨ ë°˜ë„ì²´' ì¡°ê±´ì´ í™•ì‹¤íˆ ì¡´ì¬í•˜ë„ë¡ ê°•ì œ ìƒ˜í”Œ ì¶”ê°€
    extra_samples = pd.DataFrame({
        'ë‚ ì§œ': ['2025-04-15', '2025-04-16'],
        'í†µê´€ë²ˆí˜¸': ['TX-99998', 'TX-99999'],
        'êµ­ê°€ëª…': ['ë¯¸êµ­', 'ë² íŠ¸ë‚¨'],
        'hs_code': ['8542311010', '8542311010'],
        'ìˆ˜ì¶œê¸ˆì•¡': [13500000000, 27000000000], # ì›í™” ê¸°ì¤€ ê³ ì•¡
        'ìˆ˜ì¶œì…êµ¬ë¶„': ['Export', 'Export'],
        'ì¤‘ëŸ‰': [120.5, 240.0]
    })
    
    df = pd.concat([df, extra_samples], ignore_index=True)

    # í•œê¸€ ê¹¨ì§ ë°©ì§€ë¥¼ ìœ„í•´ cp949 ì¸ì½”ë”©ìœ¼ë¡œ ì €ì¥
    file_name = 'raw_trade_data.csv'
    df.to_csv(file_name, index=False, encoding='cp949')
    
    # íŒŒì¼ ìƒì„± í™•ì¸ ë¡œì§ ì¶”ê°€
    if os.path.exists(file_name):
        print(f"âœ… íŒŒì¼ ìƒì„± ì„±ê³µ: {file_name}")
        print(f"ğŸ“ ì €ì¥ ê²½ë¡œ: {os.path.abspath(file_name)}") # ì ˆëŒ€ ê²½ë¡œ ì¶œë ¥
    else:
        print("âŒ íŒŒì¼ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ê²½ë¡œ ê¶Œí•œì„ í™•ì¸í•´ ì£¼ì„¸ìš”.")

    print(f"ğŸ“Š ì´ ë°ì´í„° í–‰ ìˆ˜: {len(df)}")
    print(f"ğŸ” ì¤‘ëŸ‰ ì»¬ëŸ¼ ê²°ì¸¡ì¹˜(NaN) ê°œìˆ˜: {df['ì¤‘ëŸ‰'].isnull().sum()}")
    print("-" * 50)
    print("ìƒì„±ëœ íŒŒì¼ì„ í™•ì¸í•˜ê³  ê³¼ì œ 1, 2 ì‹¤ìŠµì„ ì‹œì‘í•˜ì„¸ìš”.")

if __name__ == "__main__":
    generate_messy_trade_data()